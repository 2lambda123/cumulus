<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>CMR Operations · Cumulus Documentation</title><meta name="viewport" content="width=device-width, initial-scale=1.0"/><meta name="generator" content="Docusaurus"/><meta name="description" content="This document will outline basic procedures to interact with CMR on a per-granule basis, both via the Cumulus Dashboard, and Cumulus API requests."/><meta name="docsearch:version" content="v9.6.0"/><meta name="docsearch:language" content="en"/><meta property="og:title" content="CMR Operations · Cumulus Documentation"/><meta property="og:type" content="website"/><meta property="og:url" content="https://nasa.github.io/cumulus/"/><meta property="og:description" content="This document will outline basic procedures to interact with CMR on a per-granule basis, both via the Cumulus Dashboard, and Cumulus API requests."/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/cumulus/undefined"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><script src="https://unpkg.com/vanilla-back-to-top@7.1.14/dist/vanilla-back-to-top.min.js"></script><script>
        document.addEventListener('DOMContentLoaded', function() {
          addBackToTop(
            {"zIndex":100,"backgroundColor":"#2276AC"}
          )
        });
        </script><script src="/cumulus/js/scrollSpy.js"></script><link rel="stylesheet" href="/cumulus/css/main.css"/><script src="/cumulus/js/codetabs.js"></script></head><body class="sideNavVisible separateOnPageNav"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/cumulus/"><h2 class="headerTitle">Cumulus Documentation</h2></a><a href="/cumulus/versions"><h3>v9.6.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class=""><a href="https://nasa.github.io/cumulus-api" target="_self">API Docs</a></li><li class=""><a href="https://nasa.github.io/cumulus-distribution-api" target="_self">Distribution API Docs</a></li><li class=""><a href="/cumulus/docs/v9.6.0/cumulus-docs-readme" target="_self">Developer Docs</a></li><li class=""><a href="/cumulus/docs/v9.6.0/data-cookbooks/about-cookbooks" target="_self">Data-Cookbooks</a></li><li class="siteNavGroupActive"><a href="/cumulus/docs/v9.6.0/operator-docs/about-operator-docs" target="_self">Operator Docs</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><div class="hamburger-menu"><div class="line1"></div><div class="line2"></div><div class="line3"></div></div></div><h2><i>›</i><span>Operations</span></h2><div class="tocToggler" id="tocToggler"><i class="icon-toc"></i></div></div><div class="navGroups"><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">About Operator Docs<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/about-operator-docs">About Operator Docs</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Configuration<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/locating-access-logs">Locating S3 Access Logs</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/configuration/data-management-types">Cumulus Data Management Types</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Operations<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/discovery-filtering">Discovery Filtering</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/bulk-operations">Bulk Operations</a></li><li class="navListItem navListItemActive"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/cmr-operations">CMR Operations</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/naming-executions">Naming Executions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/troubleshooting/rerunning-workflow-executions">Re-running workflow executions</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/features/replay-kinesis-messages">How to replay Kinesis messages after an outage</a></li></ul></div><div class="navGroup"><h3 class="navGroupCategoryTitle collapsible">Common Use Cases<span class="arrow"><svg width="24" height="24" viewBox="0 0 24 24"><path fill="#565656" d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"></path><path d="M0 0h24v24H0z" fill="none"></path></svg></span></h3><ul class="hide"><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/ops-common-use-cases">Operator Common Use Cases</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/kinesis-stream-for-ingest">Setup Kinesis Stream &amp; CNM Message</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/create-rule-in-cumulus">Create Rule In Cumulus</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/granule-workflows">Granule Workflows</a></li><li class="navListItem"><a class="navItem" href="/cumulus/docs/v9.6.0/operator-docs/trigger-workflow">Trigger a Workflow Execution</a></li></ul></div></div></section></div><script>
            var coll = document.getElementsByClassName('collapsible');
            var checkActiveCategory = true;
            for (var i = 0; i < coll.length; i++) {
              var links = coll[i].nextElementSibling.getElementsByTagName('*');
              if (checkActiveCategory){
                for (var j = 0; j < links.length; j++) {
                  if (links[j].classList.contains('navListItemActive')){
                    coll[i].nextElementSibling.classList.toggle('hide');
                    coll[i].childNodes[1].classList.toggle('rotate');
                    checkActiveCategory = false;
                    break;
                  }
                }
              }

              coll[i].addEventListener('click', function() {
                var arrow = this.childNodes[1];
                arrow.classList.toggle('rotate');
                var content = this.nextElementSibling;
                content.classList.toggle('hide');
              });
            }

            document.addEventListener('DOMContentLoaded', function() {
              createToggler('#navToggler', '#docsNav', 'docsSliderActive');
              createToggler('#tocToggler', 'body', 'tocActive');

              var headings = document.querySelector('.toc-headings');
              headings && headings.addEventListener('click', function(event) {
                var el = event.target;
                while(el !== headings){
                  if (el.tagName === 'A') {
                    document.body.classList.remove('tocActive');
                    break;
                  } else{
                    el = el.parentNode;
                  }
                }
              }, false);

              function createToggler(togglerSelector, targetSelector, className) {
                var toggler = document.querySelector(togglerSelector);
                var target = document.querySelector(targetSelector);

                if (!toggler) {
                  return;
                }

                toggler.onclick = function(event) {
                  event.preventDefault();

                  target.classList.toggle(className);
                };
              }
            });
        </script></nav></div><div class="container mainContainer docsContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1 id="__docusaurus" class="postHeaderTitle">CMR Operations</h1></header><article><div><span><p>This document will outline basic procedures to interact with CMR on a per-granule basis, both via the Cumulus Dashboard, and Cumulus API requests.
We rely on the Cumulus API's <code>ApplyWorkflow</code> functionality to accomplish these actions.</p>
<h2><a class="anchor" aria-hidden="true" id="publishing-a-granule-to-cmr"></a><a href="#publishing-a-granule-to-cmr" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Publishing a granule to CMR</h2>
<p>Publishing a granule requires your Cumulus deployment have a workflow that contains only the <code>PostToCmr</code> task provided by Cumulus Core. The rest of this section will assume you have created this workflow under the name <code>PublishGranule</code>.</p>
<p>Using either method below, Cumulus will take an unpublished granule and publish it to CMR:</p>
<p>To do this via the dashboard, use the dashboard's <code>Execute</code> button to open the workflow popup shown below and select the <code>PublishGranule</code> workflow:</p>
<p><img src="/cumulus/docs/assets/cd_execute_publish.png" alt="Screenshot showing workflow popup window with a dropdown containing 'PublishGranule' selected"></p>
<p>An example invocation of the API to perform this action is:</p>
<pre><code class="hljs css language-bash">$ curl --request PUT https://example.com/granules/MOD11A1.A2017137.h19v16.006.2017138085750 \
--header <span class="hljs-string">'Authorization: Bearer ReplaceWithTheToken'</span> \
--header <span class="hljs-string">'Content-Type: application/json'</span> \
--data <span class="hljs-string">'{ "action": "applyWorkflow", "workflow": "PublishGranule" }'</span>
</code></pre>
<h2><a class="anchor" aria-hidden="true" id="setting-granule-access-constraints-in-cmr-metadata"></a><a href="#setting-granule-access-constraints-in-cmr-metadata" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Setting granule access constraints in CMR Metadata</h2>
<p>Updating metadata access constraints can be accomplished using the applyWorkflow functionality.
For this, we use a workflow composed of the <code>UpdateCmrAccessConstraints</code> and <code>PostToCmr</code> tasks.
<code>UpdateCmrAccessConstraints</code> will update CMR metadata file contents on S3, and <code>PostToCmr</code> will push the updates to CMR.
The rest of this section will assume you have created this workflow under the name <code>UpdateCmrAccessConstraints</code>.</p>
<p>Once created and deployed, the workflow is available in the Cumulus dashboard's <code>Execute</code> workflow selector.
However, note that additional configuration is required for this request, to supply an access constraint integer value and optional description to the <code>UpdateCmrAccessConstraints</code> workflow, by clicking the <code>Add Custom Workflow Meta</code> option in the <code>Execute</code> popup, as shown below:</p>
<p><img src="/cumulus/docs/assets/cd_execute_updateconstraints.png" alt="Screenshot showing granule execute popup with 'updateCmrAccessConstraints' selected and configuration values shown in a collapsible JSON field"></p>
<p>An example invocation of the API to perform this action is:</p>
<pre><code class="hljs css language-bash">$ curl --request PUT https://example.com/granules/MOD11A1.A2017137.h19v16.006.2017138085750 \
--header <span class="hljs-string">'Authorization: Bearer ReplaceWithTheToken'</span> \
--header <span class="hljs-string">'Content-Type: application/json'</span> \
--data <span class="hljs-string">'{
  "action": "applyWorkflow",
  "workflow": "updateCmrAccessConstraints",
  "meta": {
    accessConstraints: {
      value: 5,
      description: "sample access constraint"
    }
  }
}'</span>
</code></pre>
<p>Supported CMR metadata formats for the above operation are Echo10XML and UMMG-JSON, which will populate the <code>RestrictionFlag</code> and <code>RestrictionComment</code> fields in Echo10XML, or the <code>AccessConstraints</code> values in UMMG-JSON.</p>
<h2><a class="anchor" aria-hidden="true" id="additional-operations"></a><a href="#additional-operations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Additional Operations</h2>
<p>At this time Cumulus does not, out of the box, support additional operations on CMR metadata. However, given the examples shown above, we recommend working with your integrators to develop additional workflows that perform any required operations.</p>
<h2><a class="anchor" aria-hidden="true" id="bulk-cmr-operations"></a><a href="#bulk-cmr-operations" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Bulk CMR operations</h2>
<p>In order to perform the above operations in bulk, Cumulus supports the use of <code>ApplyWorkflow</code> in an <code>AsyncOperation</code>. These are accessed via the <code>Bulk Operation</code> button on the dashboard, or the <code>/granules/bulk</code> endpoint on the Cumulus API.</p>
<p>More information on bulk operations are in the <a href="../operator-docs/bulk-operations">bulk operations operator doc</a>.</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="/cumulus/docs/v9.6.0/operator-docs/bulk-operations"><span class="arrow-prev">← </span><span>Bulk Operations</span></a><a class="docs-next button" href="/cumulus/docs/v9.6.0/operator-docs/naming-executions"><span>Naming Executions</span><span class="arrow-next"> →</span></a></div></div></div><nav class="onPageNav"><ul class="toc-headings"><li><a href="#publishing-a-granule-to-cmr">Publishing a granule to CMR</a></li><li><a href="#setting-granule-access-constraints-in-cmr-metadata">Setting granule access constraints in CMR Metadata</a></li><li><a href="#additional-operations">Additional Operations</a></li><li><a href="#bulk-cmr-operations">Bulk CMR operations</a></li></ul></nav></div></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
                document.addEventListener('keyup', function(e) {
                  if (e.target !== document.body) {
                    return;
                  }
                  // keyCode for '/' (slash)
                  if (e.keyCode === 191) {
                    const search = document.getElementById('search_input_react');
                    search && search.focus();
                  }
                });
              </script><script>
              var search = docsearch({
                
                apiKey: '1a3df8fed03e0ad718e663c44a94fe41',
                indexName: 'nasa_cumulus',
                inputSelector: '#search_input_react',
                algoliaOptions: {"facetFilters":["version:v9.6.0"]}
              });
            </script></body></html>